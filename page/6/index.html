
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>LittleQ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="LittleQ">
    

    
    <meta name="description" content="数据开发工程师的成长历程">
<meta property="og:type" content="website">
<meta property="og:title" content="LittleQ">
<meta property="og:url" content="http://sjq597.github.io/page/6/index.html">
<meta property="og:site_name" content="LittleQ">
<meta property="og:description" content="数据开发工程师的成长历程">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LittleQ">
<meta name="twitter:description" content="数据开发工程师的成长历程">

    
    <link rel="alternative" href="/atom.xml" title="LittleQ" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="LittleQ" title="LittleQ"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="LittleQ">LittleQ</a></h1>
				<h2 class="blog-motto">爱好：写代码</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:sjq597.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/02/20/Hive-参数设置/" title="Hive 参数设置" itemprop="url">Hive 参数设置</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-02-20T06:14:10.000Z" itemprop="datePublished"> 发表于 2016-02-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="Hive参数设置方式"><a href="#Hive参数设置方式" class="headerlink" title="Hive参数设置方式"></a>Hive参数设置方式</h2><p>Hive提供了很多可设置参数，可以通过设置不同的参数来满足不同场景的各种需求，改变Hive有三种方式：</p>
<ol>
<li>修改Hive安装路径下的配置文件，即修改${HIVE_HOME}/conf/hive-site.xml文件里的配置；</li>
<li>在启动Hive时，在命令行里面设置参数；</li>
<li>在进入Hive的CLI客户端里面进行参数设置。</li>
</ol>
<h3 id="修改配置文件设置参数"><a href="#修改配置文件设置参数" class="headerlink" title="修改配置文件设置参数"></a>修改配置文件设置参数</h3><p>在安装好Hive之后，默认的配置会在${hive_home}/conf/hive-default.xml文件里面，一般都会对默认的配置做一定的修改，如果要修改默认配置，可以先在相同目录下创建一个<code>hive-site.xml</code>,格式如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span></div><div class="line">	    location of default database for the warehouse</div><div class="line">	<span class="tag">&lt;/<span class="name">description</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>所有的配置都是以<code>&lt;configuration&gt;&lt;/configuration&gt;</code>标签里面，里面可以有多个<code>&lt;property&gt;&lt;/property&gt;</code>标签，每个<code>&lt;property&gt;&lt;/property&gt;</code>标签里面可以设定我们需要设定的属性值：</p>
<ol>
<li><code>&lt;name&gt;&lt;/name&gt;:</code>要设定的属性的属性名</li>
<li><code>&lt;value&gt;&lt;/value&gt;:</code>设定属性的值</li>
<li><code>&lt;description&gt;&lt;/description&gt;:</code>描述属性的一些介绍性语句，可以不写<br>大部分共同的配置都是写到这里的，如果有必要的话，因为这里面的配置对全局用户都有效，并且一旦设置就永久有效。并且<code>hive-site.xml</code>里的配置会覆盖<code>hive-default.xml</code>里的配置，并且由于Hive是作为Hadoop的客户端启动的，所以Hive同时也会读取Hadoop的配置，同理，Hive的配置会覆盖Hadoop的配置。</li>
</ol>
<h3 id="命令行设置参数"><a href="#命令行设置参数" class="headerlink" title="命令行设置参数"></a>命令行设置参数</h3><p>在命令行启动Hive进入CLI的时候，可以在命令行里面添加<code>--hiveconf param=value</code>来设定参数，例如，在终端里输入：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hive --hiveconf mapreduce.job.queuename=queue1</div></pre></td></tr></table></figure></p>
<p>这个是设置MapReduce任务的队列，注意这个设置是临时的，一旦你退出了Hive客户端，这个配置就失效了，下次如果想使用这个配置，你必须重新配置。</p>
<h3 id="进入Hive的CLI客户端设置参数"><a href="#进入Hive的CLI客户端设置参数" class="headerlink" title="进入Hive的CLI客户端设置参数"></a>进入Hive的CLI客户端设置参数</h3><p>当我们已经进入了CLI里面，可以使用<code>set</code>关键字来设置参数，例如：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt;hive set mapreduce.job.queuename=queue1;</div></pre></td></tr></table></figure></p>
<p>这个和上一种方式差不多，效果也是一样，一旦退出CLI客户端，也会失效，但是和方法二有一个不同的地方是，如果set后面只跟参数名而不带参数值，就可以查看这个参数目前的值，像下面这样：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;hive set mapreduce.job.queuename;</div><div class="line">mapreduce.job.queuename=queue1</div></pre></td></tr></table></figure></p>
<p>如果set后面连参数名都不跟，那么就可以查看整个Hive的所有配置<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt;hive set;</div><div class="line">datanucleus.autoCreateSchema=true</div><div class="line">datanucleus.autoStartMechanismMode=checked</div><div class="line">datanucleus.cache.level2=false</div><div class="line">datanucleus.cache.level2.type=none</div><div class="line">datanucleus.connectionPoolingType=DBCP</div><div class="line">datanucleus.identifierFactory=datanucleus</div><div class="line">datanucleus.plugin.pluginRegistryBundleCheck=LOG</div><div class="line">datanucleus.storeManagerType=rdbms</div><div class="line">datanucleus.transactionIsolation=read-committed</div></pre></td></tr></table></figure></p>
<p>上面介绍的这三种参数设置方式的优先级类似于编程语言里的变量声明，即本地变量会覆盖全局变量，优先级是依此递增的</p>
<h2 id="常用Hive配置"><a href="#常用Hive配置" class="headerlink" title="常用Hive配置"></a>常用Hive配置</h2><p>注意，这些设置里面没有双引号<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># 设置job名</div><div class="line">set mapred.job.name=这是一个测试;</div><div class="line"># 设置job执行队列名</div><div class="line">set mapred.job.queue.name=root.tcop;</div><div class="line"># 设定reduce内存大小,单位M</div><div class="line">set mapreduce.reduce.memory.mb=8048;</div><div class="line">set mapred.child.reduce.java.opts=-Xmx8048M;</div><div class="line">set mapreduce.reduce.java.opts=-Xmx8048M;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Hive笔记/">Hive笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Hive/">Hive</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/02/06/Ubuntu-an-operation-is-already-pending/" title="Ubuntu an operation is already pending" itemprop="url">Ubuntu an operation is already pending</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-02-06T04:06:29.000Z" itemprop="datePublished"> 发表于 2016-02-06</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>在Ubuntu 14.04 上插硬盘，结果,无法挂载<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">An operation <span class="keyword">is</span> already pending</div></pre></td></tr></table></figure></p>
<p>解决方案，在终端中运行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gsettings <span class="built_in">set</span> org.gnome.desktop.media-handling automount <span class="literal">false</span></div></pre></td></tr></table></figure></p>
<p>然后把硬盘拔了重新插上就可以挂载了。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Linux使用/">Linux使用</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux/">Linux</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/02/04/Centos-6-4-安装matplotlib包/" title="Centos 6.4 安装matplotlib包" itemprop="url">Centos 6.4 安装matplotlib包</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-02-04T11:20:11.000Z" itemprop="datePublished"> 发表于 2016-02-04</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>官方推荐的安装方法：</p>
<ul>
<li>Debian / Ubuntu : sudo apt-get install python-matplotlib</li>
<li>Fedora / Redhat : sudo yum install python-matplotlib</li>
</ul>
<p>判断是否安装成功的方法，在python交互式环境下:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> matplotlib</div></pre></td></tr></table></figure></p>
<p>如果没有报错，则说明安装成功了，如果这样还不成功，可以通过pip来安装，如何安装pip,<br>参见文章<a href="../../../2016/01/14/服务器安装pip工具">服务器安装pip工具</a>,具体的命令就是：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ sudo wget --no-check-certificate https://bootstrap.pypa.io/ez_setup.py</div><div class="line">$ sudo python ez_setup.py --insecure</div><div class="line">$ sudo wget --no-check-certificate https://pypi.python.org/packages/<span class="built_in">source</span>/p/pip/pip-7.1.2.tar.gz</div><div class="line">$ sudo tar -xvf pip-7.1.2.tar.gz</div><div class="line">$ <span class="built_in">cd</span> pip-7.1.2</div><div class="line">$ sudo python setup.py install</div></pre></td></tr></table></figure></p>
<h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo pip <span class="keyword">install</span> module_name</div></pre></td></tr></table></figure>
<p>如果使用pip安装不成功，可以通过编译<code>matplotlib</code>源码来手动安装，<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ sudo wget --no-check-certificate https://pypi.python.org/packages/<span class="built_in">source</span>/m/matplotlib/matplotlib-1.5.1.tar.gz </div><div class="line">$ sudo tar -xvf matplotlib-1.5.1.tar.gz</div><div class="line">$ <span class="built_in">cd</span> matplotlib-1.5.1</div><div class="line">$ python setup.py build</div><div class="line">$ python setup.py install</div></pre></td></tr></table></figure></p>
<p>但是我在执行<code>python setup.py build</code>的时候，,提示缺少依赖，无法构建，缺少依赖,根据<code>build</code>打印出的信息，把必须的依赖里为<code>no</code>的包都装上，基本就是<code>libpng</code>,<code>freetype</code>这两个，具体如何安装，可以先执行：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ yum list | grep libpng</div></pre></td></tr></table></figure></p>
<p>从打印出来的结果里挑一个适合你系统的版本，记住，如果正统的版本安装了还不行，你还需要安装<code>libpng-devel</code>这种类似的名字的包，是情况而定。<br>然后所有的依赖安装好了之后，终于<code>build</code>成功了，但是我在执行<code>install</code>的时候，还是出错了，<code>gcc-plus</code>错误，出现这种错误是由于没有装<code>g++</code>的库，安装方法：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$ yum list | grep gcc</div><div class="line">gcc.x86_64                             4.4.7-3.el6                 @base        </div><div class="line">gcc-c++.x86_64                         4.4.7-3.el6                 @base        </div><div class="line">libgcc.x86_64                          4.4.7-3.el6                 @anaconda-CentOS-201303020151.x86_64/6.4</div><div class="line">compat-gcc-34.x86_64                   3.4.6-19.el6                base         </div><div class="line">compat-gcc-34-c++.x86_64               3.4.6-19.el6                base         </div><div class="line">compat-gcc-34-g77.x86_64               3.4.6-19.el6                base         </div><div class="line">gcc-gfortran.x86_64                    4.4.7-3.el6                 base         </div><div class="line">gcc-gnat.x86_64                        4.4.7-3.el6                 base         </div><div class="line">gcc-java.x86_64                        4.4.7-3.el6                 base         </div><div class="line">gcc-objc.x86_64                        4.4.7-3.el6                 base         </div><div class="line">gcc-objc++.x86_64                      4.4.7-3.el6                 base         </div><div class="line">libgcc.i686                            4.4.7-3.el6                 base         </div><div class="line">mingw32-gcc.x86_64                     4.4.6-4.el6                 base         </div><div class="line">mingw32-gcc-c++.x86_64                 4.4.6-4.el6                 base         </div><div class="line">mingw32-gcc-gfortran.x86_64            4.4.6-4.el6                 base         </div><div class="line">mingw32-gcc-objc.x86_64                4.4.6-4.el6                 base         </div><div class="line">mingw32-gcc-objc++.x86_64              4.4.6-4.el6                 base</div></pre></td></tr></table></figure></p>
<p>可以看到有很多包，你可以都装上，但是此处我们只需要<code>gcc-c++.x86_64</code>，装完之后，然后重新执行<code>python setup.py install</code>安装即可。然后再进入<code>python</code>交互式环境就可以引用<code>matplotlib</code>包了。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/开发环境/">开发环境</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux/">Linux</a><a href="/tags/Python/">Python</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/20/CentOS6-4-配置Python开发环境/" title="CentOS6.4 配置Python开发环境" itemprop="url">CentOS6.4 配置Python开发环境</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-01-20T06:08:46.000Z" itemprop="datePublished"> 发表于 2016-01-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>最近写Python脚本,需要在服务器上运行,也没办法用PyCharm这种带界面的IDE来写Python,不过看了一篇博客,讲的十分不错,所以自己照着弄了一遍,中间有些不够详细的我也一并记录下来.</p>
<h3 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h3><p>OS:Linux/Unix(服务器是CentOS6.4 64bit)<br>Vim: &gt;=vim 7.3(终端直接输入vim –version 可以查看版本)<br>Python: 具体的没试过,我的是Python2.7.4</p>
<h3 id="Vim扩展"><a href="#Vim扩展" class="headerlink" title="Vim扩展"></a>Vim扩展</h3><p>Vim之所以好用,一方面是自身的快捷键很强大,记熟了确实很好用,但是纵观任何一个流行的编辑器,更为重要的一点是可扩展性极强,每个人都可以定制和扩展,最终打造一个最适合自己的编辑器,这个可以说是每个流行的编辑器,浏览器也是如此得以流行的不可或缺的原因.插件太多,一个一个来装太麻烦,并且多了管理起来也不方便,换个系统又得一个一个安装,太麻烦,所以我们需要的第一个东西是:好用的扩展管理器.<br>Vim的扩展通常我们叫bundle或者插件</p>
<h3 id="Vundle"><a href="#Vundle" class="headerlink" title="Vundle"></a>Vundle</h3><p>Vim的编辑器很多,我就随便选一个了,普通的用也没区别,强烈推荐<code>Vundle</code>.<br>先来安装Vundle:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> https://github.com/gmarik/Vundle.vim.git ~/.vim/bundle/vundle</div></pre></td></tr></table></figure></p>
<p>上面的这个只是把Vundle插件管理器下载下来了,并且把插件放在了<code>~/.vim/bundle/</code>目录中,现在通过编辑<code>~/.vimrc</code>来配置Vim编辑器来安装Vundle,如果没有则自己创建一个:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">touch ~/.vimrc</div></pre></td></tr></table></figure></p>
<p>接下在把下面的代码放到<code>~/.vimrc</code>文件顶部:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">set</span> nocompatible              <span class="string">" required</span></div><div class="line">filetype off                  " required</div><div class="line"></div><div class="line"><span class="string">" set the runtime path to include Vundle and initialize</span></div><div class="line">set rtp+=~/.vim/bundle/vundle</div><div class="line">call vundle#begin()</div><div class="line"></div><div class="line">" alternatively, pass a path <span class="built_in">where</span> Vundle should install plugins</div><div class="line"><span class="string">"call vundle#begin('~/some/path/here')</span></div><div class="line"></div><div class="line">" <span class="built_in">let</span> Vundle manage Vundle, required</div><div class="line">Plugin <span class="string">'gmarik/vundle'</span></div><div class="line"></div><div class="line"><span class="string">" Add all your plugins here (note older versions of Vundle used Bundle instead of Plugin)</span></div><div class="line"></div><div class="line"></div><div class="line">" All of your Plugins must be added before the following line</div><div class="line">call vundle<span class="comment">#end()            " required</span></div><div class="line">filetype plugin indent on    <span class="string">" required</span></div></pre></td></tr></table></figure></p>
<p>这样就完成了Vundle的设置,然后就可以安装了,打开Vim编辑器,输入下面的命令:<br><figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">:PluginInstall</span></div></pre></td></tr></table></figure></p>
<p>这个命令非常好用,它告诉Vundle施展它的魔法——自动下载所有的插件，并为你进行安装和更新。</p>
<h3 id="开始打造IDE"><a href="#开始打造IDE" class="headerlink" title="开始打造IDE"></a>开始打造IDE</h3><p>如果你对Vim不熟,可以看看我的这篇文章:<a href="">Vim-常用命令总结</a>,常用的一些命令基本就在这了.好了,开始正式配置Vim了.</p>
<h4 id="代码折叠"><a href="#代码折叠" class="headerlink" title="代码折叠"></a>代码折叠</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">" Enable folding</span></div><div class="line">set foldmethod=indent</div><div class="line">set foldlevel=99</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/开发环境/">开发环境</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux/">Linux</a><a href="/tags/Python/">Python</a><a href="/tags/Vim/">Vim</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/20/Python2.x-os-join-报错/" title="Python2.x os.path.join /报错" itemprop="url">Python2.x os.path.join /报错</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-01-20T03:29:40.000Z" itemprop="datePublished"> 发表于 2016-01-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>我们在实际编程中经常会用到加载路径中的一些指定的文件,这就涉及到路径的拼接,<code>Unix/Linux</code>中的路径是<code>/</code>分隔,但是<code>Windows</code>中路径分隔是<code>\\</code>.所以自己拼接路径容易出错,python直接提供了路径拼接函数帮我们完成这些麻烦的事情.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">os.path.join(path1,path2,path3....)</div></pre></td></tr></table></figure></p>
<p>它会根据系统的不同,自动选择使用<code>/</code>或者<code>\\</code>来连接两个字符串路径.</p>
<p>但是在服务器上使用这个函数来拼接字符串的时候,如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">os.path.join(<span class="string">'/home/bin'</span>, /python<span class="string">')</span></div></pre></td></tr></table></figure></p>
<p>输出结果是:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'/python'</span></div></pre></td></tr></table></figure></p>
<p>正常情况下应该输出<code>/home/bin/python</code>,但是好像这个没起作用.<br><strong>注意:</strong>这个里面两个路径都是<code>/</code>开头,经测试,这个函数在python2.6.6和python2.7.10+上测试都是一样的,官方给出的解释是:</p>
<blockquote>
<p>如果路径前面带有/,那么python会认为这是一个绝对路径,所以就不需要再拼接路径了</p>
</blockquote>
<p><strong>切记:</strong>在使用这个函数拼接绝对路径的时候,最前面那个路径可以带<code>/</code>开头,但是后面的路径开头必须是不带<code>/</code>的一个字符串.</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Python笔记/">Python笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Python/">Python</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/14/服务器安装pip工具/" title="服务器安装pip工具" itemprop="url">服务器安装pip工具</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-01-14T07:03:17.000Z" itemprop="datePublished"> 发表于 2016-01-14</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>系统版本:CentOS release 6.4 (Final)<br>Python版本:2.6.6</p>
<h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><ol>
<li><p>先下载安装setuptools</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo wget --no-check-certificate https://bootstrap.pypa.io/ez_setup.py</div><div class="line">sudo python ez_setup.py --insecure</div></pre></td></tr></table></figure>
</li>
<li><p>然后下载安装pip</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo wget --no-check-certificate https://pypi.python.org/packages/<span class="built_in">source</span>/p/pip/pip-7.1.2.tar.gz</div><div class="line">sudo tar -xvf pip-7.1.2.tar.gz</div><div class="line"><span class="built_in">cd</span> pip-7.1.2</div><div class="line">sudo python setup.py install</div></pre></td></tr></table></figure>
</li>
<li><p>pip使用方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo pip install module_name</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="安装python"><a href="#安装python" class="headerlink" title="安装python"></a>安装python</h3><p>有时候用pip安装,会提示:<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SystemError: Cannot compile <span class="string">'Python.h'</span>. Perhaps you need <span class="keyword">to</span> install <span class="keyword">python</span>-dev|<span class="keyword">python</span>-devel</div></pre></td></tr></table></figure></p>
<p>这时候不能像Ubuntu上安装<code>python-dev</code>,在CentOS上,名字变了,像如下安装:<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo yum <span class="keyword">install</span> python-devel</div></pre></td></tr></table></figure></p>
<p><strong>备注:</strong>如果是Ubuntu安装报错<code>mysql_config</code>:<br><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">    libs = mysql_config(<span class="string">"libs_r"</span>)</div><div class="line">  <span class="keyword">File</span> <span class="string">"/tmp/pip-build-a7IbwK/MySQL-python/setup_posix.py"</span>, <span class="literal">line</span> <span class="number">25</span>, <span class="keyword">in</span> mysql_config</div><div class="line">    raise EnvironmentError(<span class="string">"%s not found"</span> % (mysql_config.path,))</div><div class="line">EnvironmentError: mysql_config <span class="keyword">not</span> found</div></pre></td></tr></table></figure></p>
<p>解决方案为:<br><figure class="highlight q"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-<span class="built_in">get</span> install libmysqlclient-<span class="built_in">dev</span></div></pre></td></tr></table></figure></p>
<p>还需要升级python2.6.6至2.7.x<br>查看python2.7安装位置，假设在<code>/usr/bin/q-python2.7</code>,建立软连接<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 加-b 参数是为了覆盖之前的软链接</span></div><div class="line">sudo ln -sb /usr/bin/q-python2.7 /usr/bin/python</div></pre></td></tr></table></figure></p>
<p>这会导致yum无法使用，修复办法,编辑<code>/usr/bin/yum</code><br>将头部的python改为python2.6</p>
<p>有时候由于国内某些你懂的原因，安装包经常连不上，需要设置pip的国内镜像CentOS修改<code>~/.pip/pip.conf</code>文件，内容如下：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="section">[global]</span></div><div class="line"><span class="attr">trusted-host</span>=mirrors.aliyun.com</div><div class="line"><span class="attr">index-url</span>=http://mirrors.aliyun.com/pypi/simple/</div></pre></td></tr></table></figure></p>
<p>对应的如果是Windows,则需要在对应用户目录下修改，例如<code>C:\Users\zhangsan\pip\pip.ini</code>，内容如上。</p>
<p>指定url安装包可以这样, 以<code>Flask</code>为例:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install -<span class="selector-tag">i</span> http:<span class="comment">//mirrors.aliyun.com/pypi/simple/ Flask</span></div></pre></td></tr></table></figure></p>
<p>项目依赖打包以及环境快速恢复:<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># 依赖导出</span></div><div class="line">pip freeze &gt; requirements.txt</div><div class="line"></div><div class="line"><span class="meta"># 安装文件中所有依赖</span></div><div class="line">pip install -r requirements.txt</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/开发环境/">开发环境</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux/">Linux</a><a href="/tags/Python/">Python</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/07/Django-笔记04/" title="Django 笔记04" itemprop="url">Django 笔记04</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-01-07T06:15:22.000Z" itemprop="datePublished"> 发表于 2016-01-07</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>通过第三篇笔记我们也基本知道怎么处理Web的视图和数据库及链接和模板,这次主要讲一讲表单,因为Web免不了要提交数据给服务器,表单作为一种非常常见和基本的提交数据的方式,在Web开发中是很重要的一种方法.</p>
<h3 id="一个简单的表单"><a href="#一个简单的表单" class="headerlink" title="一个简单的表单"></a>一个简单的表单</h3><p>更新我们的模板文件,编辑<code>polls/detail.html</code>,改成如下内容:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;h1&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/h1&gt;</div><div class="line"></div><div class="line">&#123;% if error_message %&#125;&lt;p&gt;&lt;strong&gt;&#123;&#123; error_message &#125;&#125;&lt;/strong&gt;&lt;/p&gt;&lt;% endif %&#125;</div><div class="line"></div><div class="line">&lt;form action="&#123;% url 'polls:vote' question.id %&#125;" method="post"&gt;</div><div class="line">    &#123;% csrf_token %&#125;</div><div class="line">    &#123;% for choice in question.choice_set.all %&#125;</div><div class="line">        &lt;input type="radio" name="choice" id="choice&#123;&#123;forloop.counter&#125;&#125;" value="&#123;&#123; choice.id&#125;&#125;"/&gt;</div><div class="line">        &lt;label for="choice&#123;&#123;forloop.counter&#125;&#125;"&gt;&#123;&#123; choice.choice_text &#125;&#125;&lt;/label&gt;&lt;br/&gt;</div><div class="line">    &lt;% endfor %&#125;</div><div class="line"></div><div class="line">    &lt;input type="submit" value="Vote" /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<ul>
<li><p>上面的是一个简单的单选按钮的模板，每一个投票选项是一个单选按钮，然后这个单选按钮的值就是关联的问题选项的<code>id</code>。每个单选按钮的名字都一样，是<code>choice</code>，也就是如果你选了某个选项，那么POST的数据就是<code>choice=#id</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">url(<span class="string">r'^(?P&lt;question_id&gt;[0-9]+)/vote/$'</span>, views.vote, name=<span class="string">'vote'</span>),</div></pre></td></tr></table></figure>
</li>
<li><p><strong>forloop.counter</strong>暗示了有多少个选项，其实就是外层循环次数。</p>
</li>
<li><code> {% csrf_token %} </code>是个防止跨域攻击的标签，只需要知道这么用就行了。</li>
</ul>
<p>这回我们可以来完善一下我们的<code>vote</code>视图，让它有一些功能，编辑<code>polls/views.py</code>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.core.urlresolvers <span class="keyword">import</span> reverse</div><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse, HttpResponseRedirect</div><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, get_object_or_404</div><div class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Question, Choice</div><div class="line"><span class="comment"># 省略其他视图</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    question = get_object_or_404(Question, pk=question_id)</div><div class="line"></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        select_choice = question.choice_set.get(pk=request.POST[<span class="string">'choice'</span>])</div><div class="line">    <span class="keyword">except</span> (KeyError, Choice.DoesNotExist):</div><div class="line">        <span class="comment"># 重新展示问题的投票按钮</span></div><div class="line">        <span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;</div><div class="line">            <span class="string">'question'</span>: question,</div><div class="line">            <span class="string">'error_message'</span>: <span class="string">"You didn't select a choice."</span></div><div class="line">        &#125;)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        select_choice.votes += <span class="number">1</span></div><div class="line">        select_choice.save()</div><div class="line"></div><div class="line">        <span class="comment"># 投票成功之后要重定向到一个结果网页</span></div><div class="line">        <span class="keyword">return</span> HttpResponseRedirect(reverse(<span class="string">'polls:results'</span>, args=(question.id,)))</div></pre></td></tr></table></figure></p>
<p>有一些代码需要解释一下，好多前面并没有介绍过：</p>
<ul>
<li><strong>request.POST</strong>就像一个字典一样，你可以通过key来访问表单提交的数据，<code>request.POST[&#39;choice&#39;]</code>返回的是选项的<code>id</code>，不过返回的是个字符串形式，因为它返回的始终是字符串形式。</li>
<li><strong>request.POST[‘choice’]</strong>会抛出一个<code>KeyError</code>当这个值没有提供的时候，这里我们的处理是没提供就返回到提交投票的表单并且给出一个信息提示。</li>
<li>当投票成功之后，代码中返回了一个<code>HttpResponseRedirect</code>而不是普通的<code>HttpResponse</code>,这个函数还可以带参数，可以重定向到我们想访问的网址,建议当我们成功处理的一个POST请求的时候都可以这么做。<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="regexp">/polls/</span><span class="number">3</span><span class="regexp">/results/</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>这个3就是参数中带的<code>question.id</code>的值。<br>当某个人对这个问题投票的时候，<code>vote()</code>视图将会重定向到结果页面，还需要增加一个<code>results()</code>视图，编辑<code>polls/views.py</code>：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">results</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    question = get_object_or_404(Question, pk=question_id)</div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/results.html'</span>, &#123;<span class="string">'question'</span>: question&#125;)</div></pre></td></tr></table></figure></p>
<p>这个和之前的<code>detail()</code>视图非常相似，用到了<code>results.html</code>模板，新建<code>template/polls/results.html</code>文件:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;h1&gt;&#123;&#123; question.question_text &#125;&#125;&lt;/h1&gt;</div><div class="line"></div><div class="line">&lt;ul&gt;</div><div class="line">    &#123;% for choice in question.choice_set.all %&#125;</div><div class="line">        &lt;li&gt;&#123;&#123; choice.choice_text &#125;&#125; -- &#123;&#123; choice.votes &#125;&#125; vote &#123;&#123; choice.votes | pluralize &#125;&#125;&lt;/li&gt;</div><div class="line">    &lt;% endfor %&#125;</div><div class="line">&lt;/ul&gt;</div><div class="line"></div><div class="line">&lt;a href="&#123;% url 'polls:detail' question.id %&#125;"&gt;Vote again?&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>此时如果你直接运行，访问<code>polls/1/</code>这个链接里面是空的，因为你的数据库里没有<code>Choice</code>,你可以直接在命令行中运行插入，或者一个简单的，直接按照前面讲的，把<code>choice</code>模块注册到<code>admin</code>模块中管理，就可以在网页上直接操作了，加入注册模块也很简单，修改<code>polls/admin.py</code>文件，内容如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</div><div class="line"></div><div class="line"><span class="comment"># Register your models here.</span></div><div class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Question, Choice</div><div class="line"></div><div class="line">admin.site.register(Question)</div><div class="line">admin.site.register(Choice)</div></pre></td></tr></table></figure></p>
<p>然后就去管理员后台直接添加几个选项和问题吧。添加完毕然后再访问，就会出现一个问题和对应的投票选项，就像我们做选择题一样，一个题有几个选项。假设我们什么都不选，然后点提交。会得到一个错误信息，就显示在选项上面<strong>You didn’t select a choice.</strong></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Django/">Django</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Python/">Python</a><a href="/tags/Web/">Web</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/03/Django-笔记03/" title="Django 笔记03" itemprop="url">Django 笔记03</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-01-03T10:59:05.000Z" itemprop="datePublished"> 发表于 2016-01-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>上一篇文章讲了数据库如何存储在数据库中，以及模块如何显示在网页中，利用管理模块添加管理模块。现在我们来做一个简单的投票网站，大概有以下几个页面：</p>
<h3 id="整体框架"><a href="#整体框架" class="headerlink" title="整体框架"></a>整体框架</h3><ol>
<li><code>index</code>Page:展示最近最新的问题</li>
<li><code>detail</code>Page:展示一个问题的具体描述</li>
<li><code>results</code>Page:展示具体的结果</li>
<li><code>vote</code>Page:具体投票的界面</li>
</ol>
<h3 id="增加几个视图"><a href="#增加几个视图" class="headerlink" title="增加几个视图"></a>增加几个视图</h3><p>编辑<code>polls.views.py</code>文件，内容如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"You're looking at question %s."</span> % question_id)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">results</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    response = <span class="string">"You're looking at the result of question %s."</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(response % question_id)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"You're voting on question %s."</span> % question_id)</div></pre></td></tr></table></figure></p>
<p>增加了视图，还要把视图的<code>url</code>写到<code>polls.urls</code>中：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^$'</span>, views.index, name=<span class="string">'index'</span>),</div><div class="line">    <span class="comment"># ex: /polls/5/</span></div><div class="line">    url(<span class="string">r'(?P&lt;question_id&gt;[0-9]+)/$'</span>, views.detail, name=<span class="string">'detail'</span>),</div><div class="line">    <span class="comment"># ex: /polls/5/results/</span></div><div class="line">    url(<span class="string">r'(?P&lt;question_id&gt;[0-9]+)/results/$'</span>, views.results, name=<span class="string">'results'</span>),</div><div class="line">    <span class="comment"># ex:/polls/5/vote/</span></div><div class="line">    url(<span class="string">r'(?P&lt;question_id&gt;[0-9]+)/vote/$'</span>, views.vote, name=<span class="string">'vote'</span>),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p><strong>Tips</strong>分别访问<a href="http://127.0.0.1:8000/polls/3/" target="_blank" rel="external">/pools/3/</a>,<a href="http://127.0.0.1:8000/polls/3/results/" target="_blank" rel="external">polls/3/results/</a>,<a href="http://127.0.0.1:8000/polls/3/vote/" target="_blank" rel="external">polls/3/vote/</a>会分别调用这几个模块视图,返回对应的结果.<br>稍微解释一下这个访问过程:当有个人访问<a href="http://127.0.0.1:8000/polls/3/" target="_blank" rel="external">127.0.0.1:8000/polls/3/</a>这个链接的时候,Django会加载<code>mysite.urls</code>这个模块,因为这个文件是项目的根配置链接模块,然后在这个模块里找到了对应的匹配项<code>^polls/</code>,然后把<code>3/</code>根据<code>include()</code>函数找到对应的模块的<code>urls</code>配置文件<code>polls.urls</code>,最终调用对应的视图<code>r&#39;^P&lt;question_id&gt;[0-9]+)/$</code>.调用视图的参数传递像下面这样:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">detail(request=&lt;HttpRequest object&gt;, question_id=<span class="string">'3'</span>)</div></pre></td></tr></table></figure></p>
<p>这里的<code>question_id=&#39;34&#39;</code>是从正则表达式<code>(?P&lt;question_id&gt;[0-9]+)</code>中来的,这个就是正则表达式里的一种用法,用括号括起来可以捕获正则匹配到的值,并且把他们作为参数传递给视图函数.其中<code>?P&lt;question_id&gt;</code>定义了这个匹配到的值的使用名,<code>[0-9]+</code>意思是匹配任意数字1次或者多次.</p>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>上面的是一个简单的示例,其实这个视图根本没做什么事情,一般一个视图会做两件事:返回一个<code>HttpResponse</code>包含请求页面的内容,或者返回一个异常,例如<code>Http404</code>,这个取决于你.<br>为了让视图有内容,我们从数据库里读数据,将这些数据展示在网页上,例如显示最近的5条记录,修改<code>polls/views.py</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Create your views here.</span></div><div class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Question</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</div><div class="line">    output = <span class="string">', '</span>.join([q.quetion_text <span class="keyword">for</span> q <span class="keyword">in</span> latest_question_list])</div><div class="line">    <span class="keyword">return</span> HttpResponse(output)</div></pre></td></tr></table></figure></p>
<p>这里又有一个问题了,一般的网页设计都是写死的,如果你想改变网页的展示方式,你就要取改对应的Python代码,所以Django采用了设计和数据分离的模板模式,下面讲一讲如何使用模板来展示数据.</p>
<h3 id="网页模板"><a href="#网页模板" class="headerlink" title="网页模板"></a>网页模板</h3><p>首先在<code>polls</code>目录下创建一个<code>templates</code>目录,Django会到这个目录里找模板.在<code>mysite/settings.py</code>文件里,有如下内容:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">TEMPLATES = [</div><div class="line">    &#123;</div><div class="line">        <span class="string">'BACKEND'</span>: <span class="string">'django.template.backends.django.DjangoTemplates'</span>,</div><div class="line">        <span class="string">'DIRS'</span>: [],</div><div class="line">        <span class="string">'APP_DIRS'</span>: <span class="keyword">True</span>,</div><div class="line">        <span class="string">'OPTIONS'</span>: &#123;</div><div class="line">            <span class="string">'context_processors'</span>: [</div><div class="line">                <span class="string">'django.template.context_processors.debug'</span>,</div><div class="line">                <span class="string">'django.template.context_processors.request'</span>,</div><div class="line">                <span class="string">'django.contrib.auth.context_processors.auth'</span>,</div><div class="line">                <span class="string">'django.contrib.messages.context_processors.messages'</span>,</div><div class="line">            ],</div><div class="line">        &#125;,</div><div class="line">    &#125;,</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>看到<code>&#39;APP_DIRS&#39;: True</code>,这个会在我们刚创建的<code>templates</code>目录下扫描你已经安装的<code>APP</code>的目录里的模板.以我们这个例子为例,我们创建的模板的相对路径为:<code>polls/templates/polls/index.html</code>.当你使用的时候,直接就是<code>polls/index.html</code>.不要觉得这个麻烦,为什么要多创建一个<code>polls</code>的子目录而不是把模板文件直接放在<code>templates</code>下,这个就涉及到一个模板的查找个加载,Django默认从<code>templates</code>下查找,如果找到了就匹配第一个,所以不要省略子目录<code>polls</code>,你可以把这个看成是Java里的包的路径或者C++里的命名空间.<br>编辑<code>polls/templates/pools/index.html</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;% if latest_question_list %&#125;</div><div class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">        &#123;% for question in latest_question_list %&#125;</div><div class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/polls/&#123;&#123; question.id&#125;&#125;"</span>&gt;</span></div><div class="line">                &#123;&#123; question.question_text&#125;&#125;</div><div class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">        &#123;% endfor %&#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">&#123;% else %&#125;</div><div class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>No polls are available.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure></p>
<p>然后更新视图文件<code>polls/views.py</code>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Create your views here.</span></div><div class="line"><span class="keyword">from</span> django.template <span class="keyword">import</span> loader</div><div class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Question</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</div><div class="line">    template = loader.get_template(<span class="string">'polls/index.html'</span>)</div><div class="line">    context = &#123;</div><div class="line">        <span class="string">'latest_question_list'</span>: latest_question_list,</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> HttpResponse(template.render(context, request))</div></pre></td></tr></table></figure></p>
<p>这段代码加载了一个模板<code>polls/index.html</code>,并且给模板传递了一个上下文,这是个字典.启动服务器,访问对应的网址<code>127.0.0.1:8000/polls/</code>默认会调用<code>index()</code>视图函数,返回一个列表,就是数据库里查询出来的几条记录.<br><code>Django</code>对于这种常用的模板操作,也提供了一个简便的用法,我们来重写一下<code>index()</code>方法:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Create your views here.</span></div><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</div><div class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Question</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</div><div class="line">    context = &#123;</div><div class="line">        <span class="string">'latest_question_list'</span>: latest_question_list,</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/index.html'</span>, context)</div></pre></td></tr></table></figure></p>
<p><strong>render()</strong>函数接收三个参数,第一个是一个<code>request</code>对象,第二个是一个模板,第三个是一个可选参数,字典内容.它返回一个渲染过的模板过后的<code>HttpResponse</code>对象以及字典内容</p>
<h3 id="返回404错误"><a href="#返回404错误" class="headerlink" title="返回404错误"></a>返回404错误</h3><p>现在我们来处理一下详情<code>detail()</code>函数,编辑<code>polls/views.py</code>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        question = Question.objects.get(pk=question_id)</div><div class="line">    <span class="keyword">except</span> Question.DoseNotExists:</div><div class="line">        <span class="keyword">raise</span> Http404(<span class="string">"Question does not exist"</span>)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;<span class="string">'question'</span>: question&#125;)</div></pre></td></tr></table></figure></p>
<p>然后在<code>polls/detail.html</code>中添加简单的内容<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">&#123;&#123; question &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>同理,调用对应的方法,如果数据有,则会调用模板,没有则会跑出异常.</p>
<h3 id="get-object-or-404"><a href="#get-object-or-404" class="headerlink" title="get_object_or_404()"></a>get_object_or_404()</h3><p>由于我们经常使用这个用法,即有就获取内容,没有就抛出异常,所以Django也有一个简单的用法,重写<code>detail()</code>方法:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    question = get_object_or_404(Question, pk=question_id)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;<span class="string">'question'</span>: question&#125;)</div></pre></td></tr></table></figure></p>
<p>这个会自动捕获<code>object doesn&#39;t exist</code>这个异常,还有个类似的方法<code>get_list_or_404()</code>,在列表是空的时候会抛异常.</p>
<h3 id="使用模板系统"><a href="#使用模板系统" class="headerlink" title="使用模板系统"></a>使用模板系统</h3><p>编辑模板文件夹下的<code>polls/detail.html</code>文件:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    &#123;% for choice in question.choice_set.all %&#125;</div><div class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123; choice.choice_text &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    &#123;% endfor %&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>移除模板里的硬编码,让模板可以动态的显示内容,编辑<code>polls/index.html</code>:<br>把如下的内容:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/polls/&#123;&#123; question.id &#125;&#125;/"</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>改为:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'detail' question.id %&#125;"</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>先说一下为什么要这么改,上面一种写法为什么不好,其实可以想象,如果连接都写死,一旦我们的模板多起来了,改链接会很麻烦.其实有个简单的方法,在前面<code>urls.py</code>里,我们在写正则匹配url的时候,还定义了模板的名字,所以你可以使用<code>{% url %}</code>这个模板标签,这个是根据下面的定义来的:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="comment"># the 'name' value as called by the &#123;% url %&#125; template tag</span></div><div class="line">url(<span class="string">r'^(?P&lt;question_id&gt;[0-9]+)/$'</span>, views.detail, name=<span class="string">'detail'</span>),</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>这样当你改了外部访问链接,例如<code>127.0.0.1:8000/polls/specifics/12/</code>,你只用在<code>polls/url.py</code>里改对应的正则规则就行,模板里的代码不用改.</p>
<h3 id="URL命名空间"><a href="#URL命名空间" class="headerlink" title="URL命名空间"></a>URL命名空间</h3><p>虽然上面的方法可以让我们少改代码,但是试想一下,一个真正的工程不可能只有一个<code>APP</code>模块,Django怎么知道在找到多个的时候用那个,答案是命名空间,是的,就是C++里的那个命名空间,我们来修改<code>polls/urls.py</code>文件:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app_name = <span class="string">'polls'</span></div><div class="line">urlpatterns = [</div><div class="line">	......</div><div class="line">    ]</div></pre></td></tr></table></figure></p>
<p>然后修改<code>polls/index.html</code>文件,将<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'detail' question.id %&#125;"</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>修改为:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'polls:detail' question.id %&#125;"</span>&gt;</span>&#123;&#123; question.question_text &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>如果这样直接运行,然后访问<code>127.0.0.1:8000/polls/</code>会报错:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">u'polls'</span> <span class="keyword">is</span> <span class="keyword">not</span> a registered namespace</div></pre></td></tr></table></figure></p>
<p>解决办法是在project的<code>urls.py</code>中<code>include()</code>的时候加上<code>namespace</code>属性,编辑<code>mysite/urls.py</code>文件:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^polls/'</span>, include(<span class="string">'polls.urls'</span>, namespace=<span class="string">'polls'</span>)),</div><div class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>然后就可以访问了.</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Django/">Django</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Python/">Python</a><a href="/tags/Web/">Web</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/01/03/Django-笔记02/" title="Django 笔记02" itemprop="url">Django 笔记02</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2016-01-03T03:29:44.000Z" itemprop="datePublished"> 发表于 2016-01-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>上一篇文章简单的搭建了一个<code>Django</code>的应用,互联网的应用，最后的数据都必须存储在数据库里，所以一个Web应用不可能不用到数据库，今天简单介绍一下<code>Django</code>中如何使用和配置数据库。</p>
<h3 id="数据库设置"><a href="#数据库设置" class="headerlink" title="数据库设置"></a>数据库设置</h3><p>打开配置文件<code>mysite/settings.py</code>,默认这个配置文件是使用的<code>SQLite</code>数据库，如果只是简单的学些这个框架，做一些简单的应用，这个数据库很方便，是Python内置的，你不用再安装任何其他的驱动，包之类的。当然，如果你想使用更牛逼的数据库，例如<code>MySQL</code>，<code>PostgreSQL</code>，看配置文件的下面的内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Database</span></div><div class="line"><span class="comment"># https://docs.djangoproject.com/en/dev/ref/settings/#databases</span></div><div class="line"></div><div class="line">DATABASES = &#123;</div><div class="line">    <span class="string">'default'</span>: &#123;</div><div class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.sqlite3'</span>,</div><div class="line">        <span class="string">'NAME'</span>: os.path.join(BASE_DIR, <span class="string">'db.sqlite3'</span>),</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>ENGINE</strong>:<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">'django</span>.db.backends.sqlite3',</div><div class="line"><span class="symbol">'django</span>.db.backends.postgresql',</div><div class="line"><span class="symbol">'django</span>.db.backends.mysql',</div><div class="line"><span class="symbol">'django</span>.db.backends.oracle',</div></pre></td></tr></table></figure></p>
<p><strong>NAME</strong>:你所创建的数据库文件的地址，记得是绝对路径，默认的是<code>os.path.join(BASE_DIR,&#39;db.sqlite3&#39;)</code>。<br>如果使用的是其他的数据库，还需要数据库的用户名和密码，记得一定要安装对应的驱动，例如，使用<code>MySQL</code>要安装类似于<code>python-mysqldb</code>这样的驱动，配置文件如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">DATABASES = &#123;</div><div class="line">    <span class="string">'default'</span>: &#123;</div><div class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>, </div><div class="line">        <span class="string">'NAME'</span>: <span class="string">'test'</span>,    	<span class="comment">#你的数据库名称</span></div><div class="line">        <span class="string">'USER'</span>: <span class="string">'root'</span>,   	<span class="comment">#你的数据库用户名</span></div><div class="line">        <span class="string">'PASSWORD'</span>: <span class="string">''</span>, 	<span class="comment">#你的数据库密码</span></div><div class="line">        <span class="string">'HOST'</span>: <span class="string">''</span>, 		<span class="comment">#你的数据库主机，留空默认为localhost</span></div><div class="line">        <span class="string">'PORT'</span>: <span class="string">'3306'</span>, 	<span class="comment">#你的数据库端口</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>由于只是练手，简单的就是用默认配置了，在使用数据库之前，需要创建表，在终端里执行以下命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py migrate</div></pre></td></tr></table></figure></p>
<p>这个命令其实是会根据<code>mysite/settings.py</code>里安装的模块创建对应的表，如果某些模块需要使用数据库，它就会创建对应的表，这么看实在是强大又方便。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Application definition</span></div><div class="line"></div><div class="line">INSTALLED_APPS = [</div><div class="line">    <span class="string">'django.contrib.admin'</span>,</div><div class="line">    <span class="string">'django.contrib.auth'</span>,</div><div class="line">    <span class="string">'django.contrib.contenttypes'</span>,</div><div class="line">    <span class="string">'django.contrib.sessions'</span>,</div><div class="line">    <span class="string">'django.contrib.messages'</span>,</div><div class="line">    <span class="string">'django.contrib.staticfiles'</span>,</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>看看执行命令的输出确实是这样的,有四个模块使用了数据库：<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Operations <span class="keyword">to</span> perform:</div><div class="line">  Apply <span class="literal">all</span> migrations: admin, contenttypes, auth, sessions</div><div class="line">Running migrations:</div><div class="line">  Rendering model states<span class="params">...</span> DONE</div><div class="line">  Applying contenttypes<span class="number">.0001</span>_initial<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0001</span>_initial<span class="params">...</span> OK</div><div class="line">  Applying admin<span class="number">.0001</span>_initial<span class="params">...</span> OK</div><div class="line">  Applying admin<span class="number">.0002</span>_logentry_remove_auto_add<span class="params">...</span> OK</div><div class="line">  Applying contenttypes<span class="number">.0002</span>_remove_content_type_name<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0002</span>_alter_permission_name_max_length<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0003</span>_alter_user_email_max_length<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0004</span>_alter_user_username_opts<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0005</span>_alter_user_last_login_null<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0006</span>_require_contenttypes_0002<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0007</span>_alter_validators_add_error_messages<span class="params">...</span> OK</div><div class="line">  Applying auth<span class="number">.0008</span>_alter_user_username_max_length<span class="params">...</span> OK</div><div class="line">  Applying sessions<span class="number">.0001</span>_initial<span class="params">...</span> OK</div></pre></td></tr></table></figure></p>
<h3 id="实体类设计"><a href="#实体类设计" class="headerlink" title="实体类设计"></a>实体类设计</h3><p>在我们之前创建的一个应用里，我们来创建两个实体类：<code>Question</code>和<code>Choice</code>,每个<code>Choice</code>都关联着一个<code>Question</code>。编辑<code>polls/models.py</code>文件：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> unicode_literals</div><div class="line"></div><div class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># Create your models here.</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></div><div class="line">    question_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></div><div class="line">    quetion = models.ForeignKey(Question, on_delete=models.CASCADE)</div><div class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</div></pre></td></tr></table></figure></p>
<p><strong>NOTE:</strong>每个实体类有两个字段属性，注意<code>Choice</code>里的<code>question</code>不是字段，只是定义一个外键。</p>
<h3 id="激活模块"><a href="#激活模块" class="headerlink" title="激活模块"></a>激活模块</h3><p>现在我们已经创建了模块，剩下的我们要告诉我们的工程，<code>polls</code>这个应用要被安装，就是上面我们提到的配置文件，修改<code>mysite/settings.py</code>，改为以下内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">INSTALLED_APPS = [</div><div class="line">    <span class="string">'polls.apps.PollsConfig'</span>,</div><div class="line">    <span class="string">'django.contrib.admin'</span>,</div><div class="line">    <span class="string">'django.contrib.auth'</span>,</div><div class="line">    <span class="string">'django.contrib.contenttypes'</span>,</div><div class="line">    <span class="string">'django.contrib.sessions'</span>,</div><div class="line">    <span class="string">'django.contrib.messages'</span>,</div><div class="line">    <span class="string">'django.contrib.staticfiles'</span>,</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>然后在终端里运行下面的命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py makemigrations polls</div></pre></td></tr></table></figure></p>
<p>将会看到如下输出：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Migrations for 'polls':</div><div class="line">  polls/migrations/0001_initial.py:</div><div class="line">    - <span class="keyword">Create</span> <span class="keyword">model</span> Choice</div><div class="line">    - <span class="keyword">Create</span> <span class="keyword">model</span> Question</div><div class="line">    - <span class="keyword">Add</span> <span class="keyword">field</span> quetion <span class="keyword">to</span> choice</div></pre></td></tr></table></figure></p>
<p>运行上面的命令的意思就是说，你已经修改了你的实体类，然后想把这些改动存储到数据库里。关于这个命令目前不需要知道太详细，知道这样用就可以了，但这样还不够，还需要运行下面的命令来把这些操作生效：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py migrate</div></pre></td></tr></table></figure></p>
<p>看到如下输出就说明成功了：<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Operations <span class="keyword">to</span> perform:</div><div class="line">  Apply <span class="literal">all</span> migrations: admin, contenttypes, polls, auth, sessions</div><div class="line">Running migrations:</div><div class="line">  Rendering model states<span class="params">...</span> DONE</div><div class="line">  Applying polls<span class="number">.0001</span>_initial<span class="params">...</span> OK</div></pre></td></tr></table></figure></p>
<p>上面的命令是把改变写到数据库中，使之生效，如果不运行这个，会报错，找不到表。</p>
<h3 id="使用API交互调试"><a href="#使用API交互调试" class="headerlink" title="使用API交互调试"></a>使用API交互调试</h3><p>上回忘了说，<code>manage.py</code>有很多命令，其中有一个是交互式调试工具<code>manage.py shell</code>:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> django</div><div class="line"></div><div class="line">In [<span class="number">2</span>]: django.setup()</div><div class="line"></div><div class="line">In [<span class="number">3</span>]: <span class="keyword">from</span> polls.models <span class="keyword">import</span> Question,Choice</div><div class="line"></div><div class="line">In [<span class="number">4</span>]: Question.objects.all()</div><div class="line">Out[<span class="number">4</span>]: &lt;QuerySet []&gt;</div><div class="line"></div><div class="line"><span class="comment"># 下面我们来插入一条记录，稍微多说一句，使用`timezone.now()`来替代</span></div><div class="line"><span class="comment"># datetime.datetime.now()</span></div><div class="line">In [<span class="number">5</span>]: <span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</div><div class="line"></div><div class="line">In [<span class="number">6</span>]: q = Question(question_text=<span class="string">"What's new?"</span>, pub_date=timezone.now())</div><div class="line"><span class="comment"># 把这条记录存到数据库里</span></div><div class="line">In [<span class="number">7</span>]: q.save()</div><div class="line"></div><div class="line"><span class="comment"># 存到数据库之后这条记录就有id了</span></div><div class="line">In [<span class="number">8</span>]: q.id</div><div class="line">Out[<span class="number">8</span>]: <span class="number">1</span></div><div class="line"></div><div class="line">In [<span class="number">9</span>]: q.question_text</div><div class="line">Out[<span class="number">9</span>]: <span class="string">"What's new?"</span></div><div class="line"></div><div class="line">In [<span class="number">10</span>]: q.pub_date</div><div class="line">Out[<span class="number">10</span>]: datetime.datetime(<span class="number">2016</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">54</span>, <span class="number">39966</span>, tzinfo=&lt;UTC&gt;)</div><div class="line"></div><div class="line">In [<span class="number">11</span>]: Question.objects.all()</div><div class="line">Out[<span class="number">11</span>]: &lt;QuerySet [&lt;Question: Question object&gt;]&gt;</div></pre></td></tr></table></figure></p>
<p>看最后一行，是不是觉得根本看不出什么东西？类比于<code>Java</code>里，我们知道，有些类都会自带一个<code>toString()</code>方法，可以把一个类作为一个字符串输出来，这里我们也来定义一下类的<code>toString</code>方法。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></div><div class="line">    question_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.question_text</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></div><div class="line">    quetion = models.ForeignKey(Question, on_delete=models.CASCADE)</div><div class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.choice_text</div></pre></td></tr></table></figure></p>
<p>然后你需要退出交互式Python环境，重新进一边，就可以看到变化了：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">4</span>]: Question.objects.all()</div><div class="line">Out[<span class="number">4</span>]: &lt;QuerySet [&lt;Question: What<span class="string">'s new?&gt;]&gt;</span></div></pre></td></tr></table></figure></p>
<p>再给<code>Question</code>加一个比较常用的方法:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></div><div class="line">    question_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.question_text</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">was_published_recently</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.pub_date &gt;= timezone.now() - datetime.timedelta(days=<span class="number">1</span>)</div></pre></td></tr></table></figure></p>
<h3 id="使用admin模块"><a href="#使用admin模块" class="headerlink" title="使用admin模块"></a>使用admin模块</h3><p>这个模块主要是管理员模块，管理网站的各种权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py createsuperuser</div></pre></td></tr></table></figure></p>
<p>后面照着填就行了。开启服务器：<code>python manage.py runserver</code>,访问<code>http://127.0.0.1:8000/admin/</code>。<br>登陆进去之后界面大概是这样的：<br><img src="http://7xn9y9.com1.z0.glb.clouddn.com/Django%20%E7%AC%94%E8%AE%B00201.png" alt="Django 后台管理模块"></p>
<h3 id="导入模块到后台管理"><a href="#导入模块到后台管理" class="headerlink" title="导入模块到后台管理"></a>导入模块到后台管理</h3><p>编辑<code>polls/admin.py</code>文件，内容如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</div><div class="line"></div><div class="line"><span class="comment"># Register your models here.</span></div><div class="line"><span class="keyword">from</span> models <span class="keyword">import</span> Question</div><div class="line"></div><div class="line">admin.site.register(Question)</div></pre></td></tr></table></figure></p>
<p>把模块注册到后台管理模块中之后，就可以在管理模块中操作我们的数据了，再次刷新就可以看到我们的模块了：<br><img src="http://7xn9y9.com1.z0.glb.clouddn.com/Django%20%E7%AC%94%E8%AE%B00202.png" alt="polls模块"><br>还可以添加管理数据：<br><img src="http://7xn9y9.com1.z0.glb.clouddn.com/Django%20%E7%AC%94%E8%AE%B00203.png" alt="后台管理数据库数据"><br>这些数据会根据自己的类型选择自己的展示方式，日期的会有一个日历展示框。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Django/">Django</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Python/">Python</a><a href="/tags/Web/">Web</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/12/31/Django-笔记01/" title="Django 笔记01" itemprop="url">Django 笔记01</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="LittleQ" target="_blank" itemprop="author">LittleQ</a>
		
  <p class="article-time">
    <time datetime="2015-12-31T14:58:52.000Z" itemprop="datePublished"> 发表于 2015-12-31</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>记录一下关于学习<code>Django</code>的一些细节，主要还是网上的一些教程实在是太坑了，可能是早期的版本，所以各种报错，所以最后都是参考了官方的原版教程，以及结合着其他博客慢慢折腾出来的，这里我会尽量把作为一个新手的常用问题记录下来。</p>
<h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><blockquote>
<p>OS:Ubuntu 14.04 64bits<br>Python: 2.7.6<br>Django:1.10.dev20151230230702</p>
</blockquote>
<h3 id="安装Django"><a href="#安装Django" class="headerlink" title="安装Django"></a>安装Django</h3><p>方法很多，只讲我的方法<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /usr/dev</div><div class="line">git <span class="built_in">clone</span> git://github.com/django/django.git</div><div class="line">sudo pip install <span class="_">-e</span> django/</div></pre></td></tr></table></figure></p>
<p><strong>注意:</strong>如果没有装<code>pip</code>，可以直接在终端里装：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install python-pip</div></pre></td></tr></table></figure></p>
<p>最终目录结构看起来就是下面这样：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysite/</div><div class="line">    manage<span class="selector-class">.py</span></div><div class="line">    mysite/</div><div class="line">        __init__<span class="selector-class">.py</span></div><div class="line">        settings<span class="selector-class">.py</span></div><div class="line">        urls<span class="selector-class">.py</span></div><div class="line">        wsgi.py</div></pre></td></tr></table></figure></p>
<p>关于这些文件的用途，大概介绍一下，开始不必过多纠结这个，后面用到了会详细讲：</p>
<ol>
<li>外层的<code>mysite/</code>是工程的根目录，这个名字对于<code>Django</code>来说无所谓，你可以随便改个名字。</li>
<li><code>manage.py</code>:管家，启动服务器，数据库之类的都需要通过这个来完成。</li>
<li><code>mysite/__init__.py</code>：这个空的文件只是为了标示这个文件夹是个<code>Python</code>包。</li>
<li><code>mysite/settings.py</code>:整个工程的配置文件。</li>
<li><code>mysite/urls.py</code>:整个<code>Django</code>工程<code>url</code>映射。</li>
<li><code>mysite/wsgi.py</code>:一个供调试用的小型web服务器，类似Apache，tomcat。</li>
</ol>
<h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><p>在外层的<code>mysite</code>目录下，在终端中执行下面的命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py runserver</div></pre></td></tr></table></figure></p>
<p>此时就可以在控制台看到成功启动服务器的信息，浏览器访问<a href="http://127.0.0.1:8000/" target="_blank" rel="external">http://127.0.0.1:8000/</a>，能访问看到对应的欢迎信息则说明成功了。<br>再多说一点，如果不指定端口和IP，则默认的就是<code>127.0.0.1</code>和<code>8000</code>.着意味着你只能是在本地访问这个网址，如果要局域网里其他的机器可以访问你的这个网址，你需要像下面这样启动：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py runserver 0.0.0.0:8000</div></pre></td></tr></table></figure></p>
<p>这样服务器会监听所有的公共IP地址，你可以通过局域网其他IP地址访问这台机器的ip地址加端口号来访问对应的网址。</p>
<h3 id="创建一个应用"><a href="#创建一个应用" class="headerlink" title="创建一个应用"></a>创建一个应用</h3><p>首先看看应用和工程有什么区别？我们可以这样理解，一个应用就是完成了一些功能的一个Web程序，一个工程就是由很多应用，或者说模块组成的，各个应用完成自己的功能，组成了功能强大的工程，下面我们来创建一个应用，还是到最外层的<code>mysite</code>下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py startapp polls</div></pre></td></tr></table></figure></p>
<p>刚刚创建的<code>polls</code>文件夹的目录就像下面这样：<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">polls|master⚡ ⇒ tree</div><div class="line">.</div><div class="line">├── admin.<span class="keyword">py</span></div><div class="line">├── apps.<span class="keyword">py</span></div><div class="line">├── __init__.<span class="keyword">py</span></div><div class="line">├── migrations</div><div class="line">│   └── __init__.<span class="keyword">py</span></div><div class="line">├── models.<span class="keyword">py</span></div><div class="line">├── tests.<span class="keyword">py</span></div><div class="line">├── urls.<span class="keyword">py</span></div><div class="line">├── views.<span class="keyword">py</span></div></pre></td></tr></table></figure></p>
<p>来写我们的第一个视图，编辑<code>polls/views.py</code>文件，代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># Create your views here.</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"Hello, world. You're at the polls index."</span>)</div></pre></td></tr></table></figure></p>
<p>这个是一个最简单的视图了，为了访问到这个视图，我们需要创建一个<code>URL</code>映射，编辑<code>polls/urls.py</code>文件，最终文件看上去像下面这样：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># coding=utf-8</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</div><div class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^$'</span>, views.index, name=<span class="string">'index'</span>),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>光这样还不行，这个只是把访问这个应用时，内部如何处理映射了，但是最外层如何访问到这个内层应用，还需要在<code>mysite</code>中配置一个<code>URL</code>映射,修改<code>mysite/urls.py</code>文件：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> include, url</div><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^polls/'</span>, include(<span class="string">'polls.urls'</span>)),</div><div class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>记得要导入<code>include</code>模块。<br><strong>注意:</strong>什么时候需要使用<code>include</code>模块？当你的URL匹配中包含另外的URL匹配映射时，你需要用<code>include()</code>,对于我们的例子，当在处理<code>127.0.0.1:8000/polls/</code>这个链接时，需要用到<code>polls/urls.py</code>里面的映射，所以我们要用<code>include()</code>将其他的匹配规则包含进来。<br>一切都完成了之后，我们来启动工程：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py runserver</div></pre></td></tr></table></figure></p>
<p>同样，浏览器访问<a href="http://127.0.0.1:8000/polls/" target="_blank" rel="external">http://127.0.0.1:8000/polls/</a>,如果看到输出了：</p>
<blockquote>
<p>Hello, world. You’re at the polls index.</p>
</blockquote>
<p>则说明我们的第一个应用完成了。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Django/">Django</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Python/">Python</a><a href="/tags/Web/">Web</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/5/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/7/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Django/" title="Django">Django<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Flask/" title="Flask">Flask<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/Git/" title="Git">Git<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hive笔记/" title="Hive笔记">Hive笔记<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/JScript/" title="JScript">JScript<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux使用/" title="Linux使用">Linux使用<sup>23</sup></a></li>
		  
		
		  
			<li><a href="/categories/MySQL/" title="MySQL">MySQL<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python笔记/" title="Python笔记">Python笔记<sup>24</sup></a></li>
		  
		
		  
			<li><a href="/categories/Shell/" title="Shell">Shell<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Vim/" title="Vim">Vim<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/博客搭建/" title="博客搭建">博客搭建<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/开发环境/" title="开发环境">开发环境<sup>21</sup></a></li>
		  
		
		  
			<li><a href="/categories/数据挖掘/" title="数据挖掘">数据挖掘<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/杂七杂八/" title="杂七杂八">杂七杂八<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>63</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>41</sup></a></li>
			
		
			
				<li><a href="/tags/开发工具/" title="开发工具">开发工具<sup>19</sup></a></li>
			
		
			
				<li><a href="/tags/SQL/" title="SQL">SQL<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/Hive/" title="Hive">Hive<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/Web/" title="Web">Web<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/Shell/" title="Shell">Shell<sup>12</sup></a></li>
			
		
			
				<li><a href="/tags/开发环境/" title="开发环境">开发环境<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/Vim/" title="Vim">Vim<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Git/" title="Git">Git<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/大数据/" title="大数据">大数据<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Hadoop/" title="Hadoop">Hadoop<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Flask/" title="Flask">Flask<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/IDEA/" title="IDEA">IDEA<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Js/" title="Js">Js<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/JS/" title="JS">JS<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/可视化/" title="可视化">可视化<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Sublime-Text/" title="Sublime Text">Sublime Text<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>2</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=null&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2017 
		
		<a href="/about" target="_blank" title="LittleQ">LittleQ</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
